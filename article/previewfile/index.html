<!DOCTYPE html>
<html lang="zh-cn">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>在线预览文件 | megt</title>
    <meta name="description" content="在线预览doc、xls、ppt、pdf">
    <link rel="stylesheet" href="/blog/assets/style.6c9c4192.css">
    <link rel="modulepreload" href="/blog/assets/Home.2a6a6e12.js">
    <link rel="modulepreload" href="/blog/assets/app.4d74a0c2.js">
    <link rel="modulepreload" href="/blog/assets/article_previewfile_index.md.00b14047.lean.js">
    <link rel="modulepreload" href="/blog/assets/app.4d74a0c2.js">
    <meta name="twitter:title" content="在线预览文件 | megt">
    <meta property="og:title" content="在线预览文件 | megt">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><div class="theme"><header class="nav-bar" data-v-675d8756><div class="sidebar-button" data-v-675d8756><svg class="icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z" class></path></svg></div><a class="nav-bar-title" href="/blog/" aria-label="megt, back to home" data-v-675d8756 data-v-4a583abe><!----> megt</a><div class="flex-grow" data-v-675d8756></div><div class="nav" data-v-675d8756><nav class="nav-links" data-v-675d8756 data-v-eab3edfe><!--[--><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/blog/" data-v-b8818f8c>文章 <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/blog/paging/tag/全部/page_1.html" data-v-b8818f8c>标签 <!----></a></div></div><!--]--><!----><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item isExternal" href="https://github.com/YaoXiangMei/blog" target="_blank" rel="noopener noreferrer" data-v-b8818f8c>GitHub <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-b8818f8c><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div></nav></div><!--[--><!--]--></header><aside class="sidebar" data-v-83e92a68><nav class="nav-links nav" data-v-83e92a68 data-v-eab3edfe><!--[--><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/blog/" data-v-b8818f8c>文章 <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/blog/paging/tag/全部/page_1.html" data-v-b8818f8c>标签 <!----></a></div></div><!--]--><!----><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item isExternal" href="https://github.com/YaoXiangMei/blog" target="_blank" rel="noopener noreferrer" data-v-b8818f8c>GitHub <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-b8818f8c><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div></nav><!--[--><!--]--><ul class="sidebar-links" data-v-83e92a68><!--[--><li class="sidebar-link"><a class="sidebar-link-item" href="#使用">使用</a><!----></li><!--]--></ul><!--[--><!--]--></aside><!-- TODO: make this button accessible --><div class="sidebar-mask"></div><main class="page" data-v-7eddb2c4><div class="container" data-v-7eddb2c4><!--[--><!--]--><div style="position:relative;" class="content" data-v-7eddb2c4><div data-v-52e5224a><h1 id="利用微软的office-online在线预览office文档" tabindex="-1" data-v-52e5224a>利用微软的Office Online在线预览Office文档 <a class="header-anchor" href="#利用微软的office-online在线预览office文档" aria-hidden="true" data-v-52e5224a>#</a></h1><p data-v-52e5224a><a href="https://www.microsoft.com/zh-cn/microsoft-365/free-office-online-for-the-web" target="_blank" rel="noopener noreferrer" data-v-52e5224a>文档地址</a></p><h3 id="前置条件" tabindex="-1" data-v-52e5224a>前置条件 <a class="header-anchor" href="#前置条件" aria-hidden="true" data-v-52e5224a>#</a></h3><ol data-v-52e5224a><li data-v-52e5224a>在浏览器是可以访问的</li><li data-v-52e5224a>需要域名访问、ip无效</li><li data-v-52e5224a>支持的格式 <blockquote data-v-52e5224a><ul data-v-52e5224a><li data-v-52e5224a>Word：docx、docm、dotm、dotx</li><li data-v-52e5224a>Excel：xlsx、xlsb、xls、xlsm</li><li data-v-52e5224a>PowerPoint：pptx、ppsx、ppt、pps、pptm、potm、ppam、potx、ppsm</li></ul></blockquote></li></ol><div class="language-html" data-v-52e5224a><pre data-v-52e5224a><code data-v-52e5224a>例子
https://view.officeapps.live.com/op/view.aspx?src=xxx
https://view.officeapps.live.com/op/view.aspx?src=http://qn.gyl.huishimed.com/1646037841290/服务内容说明函.docx
</code></pre></div><!-- # pdf可以直接用链接或iframe预览

```html
例子
<iframe id="container" scr="http://qn.gyl.huishimed.com/深圳市关于留深过年补贴细则.pdf" width="100%" height="100%" frameborder="0"></iframe>
``` --><h1 id="封装成iframe，在业务中使用" tabindex="-1" data-v-52e5224a>封装成iframe，在业务中使用 <a class="header-anchor" href="#封装成iframe，在业务中使用" aria-hidden="true" data-v-52e5224a>#</a></h1><div class="language-html" data-v-52e5224a><pre data-v-52e5224a><code data-v-52e5224a>
<span class="token doctype" data-v-52e5224a><span class="token punctuation" data-v-52e5224a>&lt;!</span><span class="token doctype-tag" data-v-52e5224a>DOCTYPE</span> <span class="token name" data-v-52e5224a>html</span><span class="token punctuation" data-v-52e5224a>&gt;</span></span>
<span class="token tag" data-v-52e5224a><span class="token tag" data-v-52e5224a><span class="token punctuation" data-v-52e5224a>&lt;</span>html</span><span class="token punctuation" data-v-52e5224a>&gt;</span></span>
  <span class="token tag" data-v-52e5224a><span class="token tag" data-v-52e5224a><span class="token punctuation" data-v-52e5224a>&lt;</span>head</span><span class="token punctuation" data-v-52e5224a>&gt;</span></span>
    <span class="token tag" data-v-52e5224a><span class="token tag" data-v-52e5224a><span class="token punctuation" data-v-52e5224a>&lt;</span>meta</span> <span class="token attr-name" data-v-52e5224a>charset</span><span class="token attr-value" data-v-52e5224a><span class="token punctuation attr-equals" data-v-52e5224a>=</span><span class="token punctuation" data-v-52e5224a>&quot;</span>utf-8<span class="token punctuation" data-v-52e5224a>&quot;</span></span> <span class="token punctuation" data-v-52e5224a>/&gt;</span></span>
    <span class="token tag" data-v-52e5224a><span class="token tag" data-v-52e5224a><span class="token punctuation" data-v-52e5224a>&lt;</span>meta</span> <span class="token attr-name" data-v-52e5224a>name</span><span class="token attr-value" data-v-52e5224a><span class="token punctuation attr-equals" data-v-52e5224a>=</span><span class="token punctuation" data-v-52e5224a>&quot;</span>viewport<span class="token punctuation" data-v-52e5224a>&quot;</span></span> <span class="token attr-name" data-v-52e5224a>content</span><span class="token attr-value" data-v-52e5224a><span class="token punctuation attr-equals" data-v-52e5224a>=</span><span class="token punctuation" data-v-52e5224a>&quot;</span>width=device-width, initial-scale=1<span class="token punctuation" data-v-52e5224a>&quot;</span></span> <span class="token punctuation" data-v-52e5224a>/&gt;</span></span>
    <span class="token tag" data-v-52e5224a><span class="token tag" data-v-52e5224a><span class="token punctuation" data-v-52e5224a>&lt;</span>title</span><span class="token punctuation" data-v-52e5224a>&gt;</span></span>文件预览<span class="token tag" data-v-52e5224a><span class="token tag" data-v-52e5224a><span class="token punctuation" data-v-52e5224a>&lt;/</span>title</span><span class="token punctuation" data-v-52e5224a>&gt;</span></span>
    <span class="token tag" data-v-52e5224a><span class="token tag" data-v-52e5224a><span class="token punctuation" data-v-52e5224a>&lt;</span>style</span> <span class="token attr-name" data-v-52e5224a>type</span><span class="token attr-value" data-v-52e5224a><span class="token punctuation attr-equals" data-v-52e5224a>=</span><span class="token punctuation" data-v-52e5224a>&quot;</span>text/css<span class="token punctuation" data-v-52e5224a>&quot;</span></span><span class="token punctuation" data-v-52e5224a>&gt;</span></span><span class="token style" data-v-52e5224a><span class="token language-css" data-v-52e5224a>
      <span class="token selector" data-v-52e5224a>*</span> <span class="token punctuation" data-v-52e5224a>{</span>
        <span class="token property" data-v-52e5224a>margin</span><span class="token punctuation" data-v-52e5224a>:</span> 0<span class="token punctuation" data-v-52e5224a>;</span>
      <span class="token punctuation" data-v-52e5224a>}</span>
      <span class="token selector" data-v-52e5224a>body</span> <span class="token punctuation" data-v-52e5224a>{</span>
        <span class="token property" data-v-52e5224a>width</span><span class="token punctuation" data-v-52e5224a>:</span> 100vw<span class="token punctuation" data-v-52e5224a>;</span>
        <span class="token property" data-v-52e5224a>height</span><span class="token punctuation" data-v-52e5224a>:</span> 100vh<span class="token punctuation" data-v-52e5224a>;</span>
      <span class="token punctuation" data-v-52e5224a>}</span>
    </span></span><span class="token tag" data-v-52e5224a><span class="token tag" data-v-52e5224a><span class="token punctuation" data-v-52e5224a>&lt;/</span>style</span><span class="token punctuation" data-v-52e5224a>&gt;</span></span>
  <span class="token tag" data-v-52e5224a><span class="token tag" data-v-52e5224a><span class="token punctuation" data-v-52e5224a>&lt;/</span>head</span><span class="token punctuation" data-v-52e5224a>&gt;</span></span>
  <span class="token tag" data-v-52e5224a><span class="token tag" data-v-52e5224a><span class="token punctuation" data-v-52e5224a>&lt;</span>body</span><span class="token punctuation" data-v-52e5224a>&gt;</span></span>
    <span class="token tag" data-v-52e5224a><span class="token tag" data-v-52e5224a><span class="token punctuation" data-v-52e5224a>&lt;</span>iframe</span> <span class="token attr-name" data-v-52e5224a>id</span><span class="token attr-value" data-v-52e5224a><span class="token punctuation attr-equals" data-v-52e5224a>=</span><span class="token punctuation" data-v-52e5224a>&quot;</span>container<span class="token punctuation" data-v-52e5224a>&quot;</span></span> <span class="token attr-name" data-v-52e5224a>width</span><span class="token attr-value" data-v-52e5224a><span class="token punctuation attr-equals" data-v-52e5224a>=</span><span class="token punctuation" data-v-52e5224a>&quot;</span>100%<span class="token punctuation" data-v-52e5224a>&quot;</span></span> <span class="token attr-name" data-v-52e5224a>height</span><span class="token attr-value" data-v-52e5224a><span class="token punctuation attr-equals" data-v-52e5224a>=</span><span class="token punctuation" data-v-52e5224a>&quot;</span>100%<span class="token punctuation" data-v-52e5224a>&quot;</span></span> <span class="token attr-name" data-v-52e5224a>frameborder</span><span class="token attr-value" data-v-52e5224a><span class="token punctuation attr-equals" data-v-52e5224a>=</span><span class="token punctuation" data-v-52e5224a>&quot;</span>0<span class="token punctuation" data-v-52e5224a>&quot;</span></span><span class="token punctuation" data-v-52e5224a>&gt;</span></span><span class="token tag" data-v-52e5224a><span class="token tag" data-v-52e5224a><span class="token punctuation" data-v-52e5224a>&lt;/</span>iframe</span><span class="token punctuation" data-v-52e5224a>&gt;</span></span>
    <span class="token tag" data-v-52e5224a><span class="token tag" data-v-52e5224a><span class="token punctuation" data-v-52e5224a>&lt;</span>script</span> <span class="token attr-name" data-v-52e5224a>type</span><span class="token attr-value" data-v-52e5224a><span class="token punctuation attr-equals" data-v-52e5224a>=</span><span class="token punctuation" data-v-52e5224a>&quot;</span>text/javascript<span class="token punctuation" data-v-52e5224a>&quot;</span></span><span class="token punctuation" data-v-52e5224a>&gt;</span></span><span class="token script" data-v-52e5224a><span class="token language-javascript" data-v-52e5224a>
      <span class="token comment" data-v-52e5224a>// 获取url参数</span>
      <span class="token keyword" data-v-52e5224a>var</span> <span class="token function-variable function" data-v-52e5224a>getQueryVariable</span> <span class="token operator" data-v-52e5224a>=</span> <span class="token keyword" data-v-52e5224a>function</span> <span class="token punctuation" data-v-52e5224a>(</span><span class="token parameter" data-v-52e5224a>variable</span><span class="token punctuation" data-v-52e5224a>)</span> <span class="token punctuation" data-v-52e5224a>{</span>
        <span class="token keyword" data-v-52e5224a>var</span> query <span class="token operator" data-v-52e5224a>=</span> window<span class="token punctuation" data-v-52e5224a>.</span>location<span class="token punctuation" data-v-52e5224a>.</span>search<span class="token punctuation" data-v-52e5224a>.</span><span class="token function" data-v-52e5224a>substring</span><span class="token punctuation" data-v-52e5224a>(</span><span class="token number" data-v-52e5224a>1</span><span class="token punctuation" data-v-52e5224a>)</span><span class="token punctuation" data-v-52e5224a>;</span>
        <span class="token keyword" data-v-52e5224a>var</span> vars <span class="token operator" data-v-52e5224a>=</span> query<span class="token punctuation" data-v-52e5224a>.</span><span class="token function" data-v-52e5224a>split</span><span class="token punctuation" data-v-52e5224a>(</span><span class="token string" data-v-52e5224a>&quot;&amp;&quot;</span><span class="token punctuation" data-v-52e5224a>)</span><span class="token punctuation" data-v-52e5224a>;</span>
        <span class="token keyword" data-v-52e5224a>for</span> <span class="token punctuation" data-v-52e5224a>(</span><span class="token keyword" data-v-52e5224a>var</span> i <span class="token operator" data-v-52e5224a>=</span> <span class="token number" data-v-52e5224a>0</span><span class="token punctuation" data-v-52e5224a>;</span> i <span class="token operator" data-v-52e5224a>&lt;</span> vars<span class="token punctuation" data-v-52e5224a>.</span>length<span class="token punctuation" data-v-52e5224a>;</span> i<span class="token operator" data-v-52e5224a>++</span><span class="token punctuation" data-v-52e5224a>)</span> <span class="token punctuation" data-v-52e5224a>{</span>
          <span class="token keyword" data-v-52e5224a>var</span> pair <span class="token operator" data-v-52e5224a>=</span> vars<span class="token punctuation" data-v-52e5224a>[</span>i<span class="token punctuation" data-v-52e5224a>]</span><span class="token punctuation" data-v-52e5224a>.</span><span class="token function" data-v-52e5224a>split</span><span class="token punctuation" data-v-52e5224a>(</span><span class="token string" data-v-52e5224a>&quot;=&quot;</span><span class="token punctuation" data-v-52e5224a>)</span><span class="token punctuation" data-v-52e5224a>;</span>
          <span class="token keyword" data-v-52e5224a>if</span> <span class="token punctuation" data-v-52e5224a>(</span>pair<span class="token punctuation" data-v-52e5224a>[</span><span class="token number" data-v-52e5224a>0</span><span class="token punctuation" data-v-52e5224a>]</span> <span class="token operator" data-v-52e5224a>==</span> variable<span class="token punctuation" data-v-52e5224a>)</span> <span class="token punctuation" data-v-52e5224a>{</span>
            <span class="token keyword" data-v-52e5224a>return</span> pair<span class="token punctuation" data-v-52e5224a>[</span><span class="token number" data-v-52e5224a>1</span><span class="token punctuation" data-v-52e5224a>]</span><span class="token punctuation" data-v-52e5224a>;</span>
          <span class="token punctuation" data-v-52e5224a>}</span>
        <span class="token punctuation" data-v-52e5224a>}</span>
        <span class="token keyword" data-v-52e5224a>return</span> <span class="token boolean" data-v-52e5224a>false</span><span class="token punctuation" data-v-52e5224a>;</span>
      <span class="token punctuation" data-v-52e5224a>}</span><span class="token punctuation" data-v-52e5224a>;</span>
      <span class="token comment" data-v-52e5224a>// 获取文件扩展名</span>
      <span class="token keyword" data-v-52e5224a>var</span> <span class="token function-variable function" data-v-52e5224a>getType</span> <span class="token operator" data-v-52e5224a>=</span> <span class="token keyword" data-v-52e5224a>function</span> <span class="token punctuation" data-v-52e5224a>(</span><span class="token parameter" data-v-52e5224a>fileUrl</span><span class="token punctuation" data-v-52e5224a>)</span> <span class="token punctuation" data-v-52e5224a>{</span>
        <span class="token comment" data-v-52e5224a>// return fileUrl.split(&quot;.&quot;).pop().toLowerCase();</span>
        <span class="token keyword" data-v-52e5224a>const</span> data <span class="token operator" data-v-52e5224a>=</span> <span class="token regex" data-v-52e5224a><span class="token regex-delimiter" data-v-52e5224a>/</span><span class="token regex-source language-regex" data-v-52e5224a>\.[^\.]+$</span><span class="token regex-delimiter" data-v-52e5224a>/</span></span><span class="token punctuation" data-v-52e5224a>.</span><span class="token function" data-v-52e5224a>exec</span><span class="token punctuation" data-v-52e5224a>(</span>fileUrl<span class="token punctuation" data-v-52e5224a>)</span><span class="token punctuation" data-v-52e5224a>;</span>
        <span class="token keyword" data-v-52e5224a>return</span> data <span class="token operator" data-v-52e5224a>?</span> data<span class="token punctuation" data-v-52e5224a>[</span><span class="token number" data-v-52e5224a>0</span><span class="token punctuation" data-v-52e5224a>]</span> <span class="token operator" data-v-52e5224a>:</span> <span class="token boolean" data-v-52e5224a>false</span><span class="token punctuation" data-v-52e5224a>;</span>
      <span class="token punctuation" data-v-52e5224a>}</span><span class="token punctuation" data-v-52e5224a>;</span>
      <span class="token keyword" data-v-52e5224a>var</span> docTypes <span class="token operator" data-v-52e5224a>=</span> <span class="token punctuation" data-v-52e5224a>[</span><span class="token string" data-v-52e5224a>&quot;.doc&quot;</span><span class="token punctuation" data-v-52e5224a>,</span> <span class="token string" data-v-52e5224a>&quot;.docx&quot;</span><span class="token punctuation" data-v-52e5224a>,</span> <span class="token string" data-v-52e5224a>&quot;.xls&quot;</span><span class="token punctuation" data-v-52e5224a>,</span> <span class="token string" data-v-52e5224a>&quot;.xlsx&quot;</span><span class="token punctuation" data-v-52e5224a>,</span> <span class="token string" data-v-52e5224a>&quot;.ppt&quot;</span><span class="token punctuation" data-v-52e5224a>,</span> <span class="token string" data-v-52e5224a>&quot;.pptx&quot;</span><span class="token punctuation" data-v-52e5224a>]</span><span class="token punctuation" data-v-52e5224a>;</span>
      <span class="token keyword" data-v-52e5224a>var</span> <span class="token function-variable function" data-v-52e5224a>load</span> <span class="token operator" data-v-52e5224a>=</span> <span class="token keyword" data-v-52e5224a>function</span> <span class="token punctuation" data-v-52e5224a>(</span><span class="token punctuation" data-v-52e5224a>)</span> <span class="token punctuation" data-v-52e5224a>{</span>
        <span class="token keyword" data-v-52e5224a>var</span> fileUrl <span class="token operator" data-v-52e5224a>=</span> <span class="token function" data-v-52e5224a>getQueryVariable</span><span class="token punctuation" data-v-52e5224a>(</span><span class="token string" data-v-52e5224a>&quot;fileUrl&quot;</span><span class="token punctuation" data-v-52e5224a>)</span><span class="token punctuation" data-v-52e5224a>;</span>
        <span class="token keyword" data-v-52e5224a>if</span> <span class="token punctuation" data-v-52e5224a>(</span><span class="token operator" data-v-52e5224a>!</span>fileUrl<span class="token punctuation" data-v-52e5224a>)</span>
          <span class="token keyword" data-v-52e5224a>throw</span> <span class="token string" data-v-52e5224a>&quot;请传入文件在线地址：http://qn.gyl.huishimed.com/file-preview.html?fileUrl=xxx&quot;</span><span class="token punctuation" data-v-52e5224a>;</span>

        <span class="token keyword" data-v-52e5224a>var</span> fileType <span class="token operator" data-v-52e5224a>=</span> <span class="token function" data-v-52e5224a>getQueryVariable</span><span class="token punctuation" data-v-52e5224a>(</span><span class="token string" data-v-52e5224a>&quot;fileType&quot;</span><span class="token punctuation" data-v-52e5224a>)</span> <span class="token operator" data-v-52e5224a>||</span> <span class="token function" data-v-52e5224a>getType</span><span class="token punctuation" data-v-52e5224a>(</span>fileUrl<span class="token punctuation" data-v-52e5224a>)</span><span class="token punctuation" data-v-52e5224a>;</span>
        <span class="token comment" data-v-52e5224a>// if (!fileType) throw &quot;未知的文件&quot;;</span>

        <span class="token keyword" data-v-52e5224a>var</span> container <span class="token operator" data-v-52e5224a>=</span> document<span class="token punctuation" data-v-52e5224a>.</span><span class="token function" data-v-52e5224a>querySelector</span><span class="token punctuation" data-v-52e5224a>(</span><span class="token string" data-v-52e5224a>&quot;#container&quot;</span><span class="token punctuation" data-v-52e5224a>)</span><span class="token punctuation" data-v-52e5224a>;</span>

        <span class="token keyword" data-v-52e5224a>if</span> <span class="token punctuation" data-v-52e5224a>(</span>docTypes<span class="token punctuation" data-v-52e5224a>.</span><span class="token function" data-v-52e5224a>includes</span><span class="token punctuation" data-v-52e5224a>(</span>fileType<span class="token punctuation" data-v-52e5224a>)</span><span class="token punctuation" data-v-52e5224a>)</span> <span class="token punctuation" data-v-52e5224a>{</span>
          <span class="token comment" data-v-52e5224a>// 微软在线预览地址</span>
          <span class="token keyword" data-v-52e5224a>var</span> onlineContainerUrl <span class="token operator" data-v-52e5224a>=</span>
            <span class="token string" data-v-52e5224a>&quot;https://view.officeapps.live.com/op/view.aspx&quot;</span><span class="token punctuation" data-v-52e5224a>;</span>
          container<span class="token punctuation" data-v-52e5224a>.</span>src <span class="token operator" data-v-52e5224a>=</span> onlineContainerUrl <span class="token operator" data-v-52e5224a>+</span> <span class="token string" data-v-52e5224a>&quot;?src=&quot;</span> <span class="token operator" data-v-52e5224a>+</span> fileUrl<span class="token punctuation" data-v-52e5224a>;</span>
        <span class="token punctuation" data-v-52e5224a>}</span> <span class="token keyword" data-v-52e5224a>else</span> <span class="token punctuation" data-v-52e5224a>{</span>
          container<span class="token punctuation" data-v-52e5224a>.</span>type <span class="token operator" data-v-52e5224a>=</span> <span class="token string" data-v-52e5224a>&quot;application/x-google-chrome-pdf&quot;</span><span class="token punctuation" data-v-52e5224a>;</span>
          container<span class="token punctuation" data-v-52e5224a>.</span>src <span class="token operator" data-v-52e5224a>=</span> fileUrl<span class="token punctuation" data-v-52e5224a>;</span>
        <span class="token punctuation" data-v-52e5224a>}</span>
      <span class="token punctuation" data-v-52e5224a>}</span><span class="token punctuation" data-v-52e5224a>;</span>
      window<span class="token punctuation" data-v-52e5224a>.</span><span class="token function" data-v-52e5224a>addEventListener</span><span class="token punctuation" data-v-52e5224a>(</span><span class="token string" data-v-52e5224a>&quot;load&quot;</span><span class="token punctuation" data-v-52e5224a>,</span> load<span class="token punctuation" data-v-52e5224a>)</span><span class="token punctuation" data-v-52e5224a>;</span>
    </span></span><span class="token tag" data-v-52e5224a><span class="token tag" data-v-52e5224a><span class="token punctuation" data-v-52e5224a>&lt;/</span>script</span><span class="token punctuation" data-v-52e5224a>&gt;</span></span>
  <span class="token tag" data-v-52e5224a><span class="token tag" data-v-52e5224a><span class="token punctuation" data-v-52e5224a>&lt;/</span>body</span><span class="token punctuation" data-v-52e5224a>&gt;</span></span>
<span class="token tag" data-v-52e5224a><span class="token tag" data-v-52e5224a><span class="token punctuation" data-v-52e5224a>&lt;/</span>html</span><span class="token punctuation" data-v-52e5224a>&gt;</span></span>

</code></pre></div><h2 id="使用" tabindex="-1" data-v-52e5224a>使用 <a class="header-anchor" href="#使用" aria-hidden="true" data-v-52e5224a>#</a></h2><div class="language-js" data-v-52e5224a><pre data-v-52e5224a><code data-v-52e5224a><span class="token keyword" data-v-52e5224a>const</span> <span class="token constant" data-v-52e5224a>VITE_QIUNIU_DOMAIN</span> <span class="token operator" data-v-52e5224a>=</span> <span class="token string" data-v-52e5224a>&#39;http://qn.gyl.huishimed.com/file-preview.html&#39;</span>
<span class="token keyword" data-v-52e5224a>const</span> fileUrl <span class="token operator" data-v-52e5224a>=</span> <span class="token string" data-v-52e5224a>&#39;http://qn.gyl.huishimed.com/深圳市关于留深过年补贴细则.pdf&#39;</span> <span class="token operator" data-v-52e5224a>|</span> <span class="token string" data-v-52e5224a>&#39;http://qn.gyl.huishimed.com/1646037841290/服务内容说明函.docx&#39;</span>
window<span class="token punctuation" data-v-52e5224a>.</span><span class="token function" data-v-52e5224a>open</span><span class="token punctuation" data-v-52e5224a>(</span><span class="token template-string" data-v-52e5224a><span class="token template-punctuation string" data-v-52e5224a>`</span><span class="token interpolation" data-v-52e5224a><span class="token interpolation-punctuation punctuation" data-v-52e5224a>${</span><span class="token constant" data-v-52e5224a>VITE_QIUNIU_DOMAIN</span><span class="token interpolation-punctuation punctuation" data-v-52e5224a>}</span></span><span class="token string" data-v-52e5224a>file-preview.html?fileUrl=</span><span class="token interpolation" data-v-52e5224a><span class="token interpolation-punctuation punctuation" data-v-52e5224a>${</span>fileUrl<span class="token interpolation-punctuation punctuation" data-v-52e5224a>}</span></span><span class="token template-punctuation string" data-v-52e5224a>`</span></span><span class="token punctuation" data-v-52e5224a>)</span>
</code></pre></div><div id="gitalk-container" data-v-52e5224a></div></div></div><footer class="page-footer" data-v-7eddb2c4 data-v-fb8d84c6><div class="edit" data-v-fb8d84c6><div class="edit-link" data-v-fb8d84c6 data-v-1ed99556><!----></div></div><div class="updated" data-v-fb8d84c6><!----></div></footer><!----><!--[--><!--]--></div></main></div><!----><!--]--><!-- <Copyright /> --><!--]--></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"article_blog_index.md\":\"6462fe8a\",\"article_fiddler_index.md\":\"d8972ba9\",\"article_parse_index.md\":\"55ab95c6\",\"article_performace_index.md\":\"7f9d937d\",\"article_previewfile_index.md\":\"00b14047\",\"index.md\":\"a431f5bf\",\"paging_article_page_1.md\":\"b66ec66d\",\"paging_article_page_2.md\":\"ad376a38\",\"paging_tag_json.parse_page_1.md\":\"14b5ddfa\",\"paging_tag_bug_page_1.md\":\"81ed6eaa\",\"paging_tag_fiddler_page_1.md\":\"052bc593\",\"paging_tag_iframe_page_1.md\":\"cffa33f1\",\"paging_tag_vite_page_1.md\":\"5090d612\",\"paging_tag_vitepress_page_1.md\":\"161f4171\",\"paging_tag_代理_page_1.md\":\"b167f504\",\"paging_tag_优化_page_1.md\":\"f1d49af6\",\"paging_tag_全部_page_1.md\":\"6eec58a7\",\"paging_tag_全部_page_2.md\":\"e46c1ee2\",\"paging_tag_性能_page_1.md\":\"d0d050cf\",\"paging_tag_抓包_page_1.md\":\"7fde28d8\"}")</script>
    <script type="module" async src="/blog/assets/app.4d74a0c2.js"></script>
    
  </body>
</html>